# For: Web frontend repos (React/SPA/etc.)
name: DAST - Web App Baseline

on:
  workflow_call:
    inputs:
      target_url:
        description: 'Web app URL to scan'
        required: true
        type: string
        default: 'https://staging.yourapp.com'
      context_file:
        description: 'Optional ZAP context file (for auth)'
        required: false
        type: string
      context_url:
        description: 'Optional context URL (for auth)'
        required: false
        type: string
      user:
        description: 'Optional ZAP user (for auth)'
        required: false
        type: string
      rules_file_name:
        description: 'Optional ZAP rules file path (e.g., .zap/rules.tsv)'
        required: false
        type: string
      cmd_options:
        description: 'Optional ZAP cmd options'
        required: false
        type: string
      data_classification:
        description: 'ISO 27701 data classification (e.g., None, PII)'
        required: false
        type: string
      privacy_impact:
        description: 'ISO 27701 privacy impact summary'
        required: false
        type: string

env:
  DEFAULT_TARGET_URL: https://staging.yourapp.com

jobs:
  dast-baseline:
    name: DAST - Web Baseline
    uses: your-org/.github/.github/workflows/reusable-zap-baseline.yml@main
    with:
      target_url: ${{ inputs.target_url || env.DEFAULT_TARGET_URL }}
      scan_type: 'baseline'
      context_file: ${{ inputs.context_file }}
      context_url: ${{ inputs.context_url }}
      user: ${{ inputs.user }}
      rules_file_name: ${{ inputs.rules_file_name }}
      cmd_options: ${{ inputs.cmd_options }}
      data_classification: ${{ inputs.data_classification }}
      privacy_impact: ${{ inputs.privacy_impact }}
